---
title: 并行编排
date: 2022-06-29 16:46:16
permalink: /pages/b3446a/
---

## 最基本的例子

如果你要并行执行a,b,c三个组件，你可以用`WHEN`关键字，需要注意的是，`WHEN`必须大写。

```xml
<chain name="chain1">
    WHEN(a, b, c)
</chain>
```

## 和串行嵌套起来(一)

接下来，让我们把`THEN`和`WHEN`结合起来用，看一个示例：

```xml
<chain name="chain1">
    THEN(
        a,
        WHEN(b, c, d),
        e
    )
</chain>
```

<iframe src="https://www.processon.com/view/link/62bc89091e08530731b6e1c7" width="100%" height="300" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe>


在以上示例里，b,c,d默认并行都执行完毕后，才会执行e。

## 和串行嵌套起来(二)

上面的示例应该很好理解吧，那么再看一个示例：

```xml
<chain name="chain1">
    THEN(
        a,
        WHEN(b, THEN(c, d)),
        e
    )
</chain>
```

<iframe src="https://www.processon.com/view/link/62bc8802e401fd07588ffa86" width="100%" height="300" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe>

## 忽略错误

`WHEN`关键字提供了一个子关键字`ignoreError`来提供忽略错误的特性，用法如下：

```xml
<chain name="chain1">
    THEN(
        a,
        WHEN(b, c, d).ignoreError(true),
        e
    )
</chain>
```
<iframe src="https://www.processon.com/view/link/62bc89091e08530731b6e1c7" width="100%" height="300" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe>

以上假设b,c,d中任一一个节点有异常，那么最终e仍旧会被执行。

## 任一节点先执行完则忽略其他

`WHEN`关键字提供了一个子关键字`any`，用来提供并行流程中，任一条分支先执行完即忽略其他分支，继续执行的特性。用法如下：

```xml
<chain name="chain1">
    THEN(
        a,
        WHEN(b, THEN(c, d), e)
        f
    )
</chain>
```
<iframe src="https://www.processon.com/view/link/62bc874a7d9c08073522bf3b" width="100%" height="300" frameborder="0" scrolling="No" leftmargin="0" topmargin="0"></iframe>

以上流程，假设e节点先执行完，那么不管其他分支是否执行完，会立马执行节点f。