---
title: 复杂编排
date: 2022-06-29 21:29:06
permalink: /pages/5156b3/
---

经过上面几小章，你是不是已经大致了解了LiteFlow该如何编排了呢？

这章我们结合以上几个章节，来看下复杂流程编排的例子。

我们就拿LiteFlow介绍章节中的2个复杂例子来举例：

## 复杂例子一

:::tip 图示
<img :src="$withBase('/img/flow_example/e10.png')" style="zoom: 25%">
:::

上面这个图可以表示为以下的编排表达式：

```xml
<chain name="chain1">
    THEN(
        a,b,
        WHEN(
            THEN(c, WHEN(j,k)),
            d,
            THEN(h, i)
        ),
        SWITCH(x).to(
            m,
            n,
            WHEN(q, then(p, r))
        ),
        z
    )
</chain>
```

如果你觉得以上例子还能看懂的话，那么请看下面这个例子。

## 复杂例子二

:::tip 图示
<img :src="$withBase('/img/flow_example/e11.png')" style="zoom: 25%">
:::

上面这个图可以表示为以下的编排表达式：

```xml
<chain name="chain1">
    THEN(
        A,
        SWITCH(B).to(
            THEN(D, E, F).id("t1"),
            THEN(
                C,
                WHEN(
                    THEN(
                        SWITCH(G).to(THEN(H, I).id("t2"), J),
                        K
                    ),
                    THEN(L, M)
                )
            ).id("t3")
        ),
        Z
    )    
</chain>
```

看到这，我相信你肯定会有怀疑：这个表达式也太难看懂了吧，括号都得数半天。。。

其实，对于这种超复杂的流程，我们建议拆分子流程来做。以上的表达式可以拆分成下面的表达式：

```xml
<chain name="mainChain">
    THEN(
        A,
        SWITCH(B).to(chain2, chain3),
        Z
    )
</chain>

<chain name="chain2">
    THEN(D, E, F)
</chain>

<chain name="chain3">
    THEN(C, WHEN(chain4, chain5))
</chain>

<chain name="chain4">
    THEN(
        SWITCH(G).to(
            THEN(H, I).id("t1"), 
            J
        ),
        K
    )
</chain>

<chain name="chain5">
    THEN(L, M)
</chain>
```

执行的时候，执行`mainChain`就可以了。

是不是觉得拆分成多个子流程后，好理解多了呢。

其实可以发现，LiteFlow的表达式不仅可以无限嵌套子表达式，还可以利用拆分子chain的方式使得表达式变的更加可读。
